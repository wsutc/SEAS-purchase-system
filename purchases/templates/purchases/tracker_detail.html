{% extends 'purchases/detail_page.html' %}
{% block title %}{{ object.purchase_request }} Tracker{% endblock %}
{% block header %}Tracker{% endblock %}
{% comment %} {% block previous %}{{ object.get_previous_by_sort_order.get_absolute_url }}{% endblock previous %}
{% block next %}{{ object.get_next_by_tracking_number.get_absolute_url }}{% endblock next %} {% endcomment %}

{% block navigation %}
    <div class="row mb-3">
      <div class="col"></div>
      <div class="btn-group col-2" role="group" aria-label="Navigation">
            <a href="{% url 'update_tracker' pk=object.id %}" class="btn btn-secondary">Update Tracker</a>
      </div>
    </div>
{% endblock navigation %}

{% block page %}

<div class="container mt-4">
      <div class="card col">
        <div class="card-header">
          <h4 class="header-em">{{ object }}</h4>
        </div>
        <div class="card-body">
          <table>
            <tr>
              <td class="pe-2 fw-bold">Status</td>
              <td>{{ object.status|default_if_none:"(unknown)" }}</td>
            </tr>
            <tr>
                <td class="pe-2 fw-bold">Purchase Request</td>
                <td><a href="{{ object.purchase_request.get_absolute_url }}">{{ object.purchase_request }}</a></td>
            </tr>
            <tr>
                <td class="pe-2 fw-bold">Carrier</td>
                <td><a href="{{ object.carrier.website }}" target="_blank" rel="noopener noreferrer">{{ object.carrier }}<i class="fa-solid fa-up-right-from-square" data-fa-transform="shrink-6 up-4"></a></td>
            </tr>
            <tr>
                <td class="pe-2 fw-bold">Tracking Number</td>
                <td><a href="{{ object.get_tracking_link }}" target="_blank" rel="noopener noreferrer">{{ object.tracking_number }}<i class="fa-solid fa-up-right-from-square" data-fa-transform="shrink-6 up-4"></a></td>
            </tr>
          </table>
        </div>
      </div>
  </div>

  <div class="col-12">
    <div class="h2">Events</div>
        <div class="bd-example-snippet bd-code-snippet">
            <div class="bd-example">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Date/Time</th>
                            <th>Description</th>
                            <th>Location</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in object.trackingevent_set.all %}
                          <tr>
                            <td>{{ row.time_utc|date:"D d M Y" }} {{ row.time_utc|time:"H:i:s e" }}</td>
                            <td>{{ row.description }}</td>
                            <td>{{ row.location }}</td>
                            <td>{{ row.status }}</td>
                          </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

{% endblock %}

{% block related_pr_table %}{% endblock related_pr_table %}
{% block related_simpleproduct_table %}{% endblock related_simpleproduct_table %}